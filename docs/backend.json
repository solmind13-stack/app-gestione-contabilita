{
  "entities": {
    "Movement": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Movement",
      "type": "object",
      "description": "Represents a financial transaction or bank movement.",
      "properties": {
        "id": { "type": "string" },
        "year": { "type": "number" },
        "date": { "type": "string", "format": "date-time" },
        "description": { "type": "string" },
        "category": { "type": "string" },
        "subCategory": { "type": "string" },
        "grossIncome": { "type": "number" },
        "grossExpenses": { "type": "number" },
        "vatPercentage": { "type": "number" },
        "netIncome": { "type": "number" },
        "vatIncome": { "type": "number" },
        "netExpenses": { "type": "number" },
        "vatExpense": { "type": "number" },
        "account": { "type": "string" },
        "operator": { "type": "string" },
        "paymentMethod": { "type": "string" },
        "notes": { "type": "string" },
        "societa": { "type": "string" },
        "createdBy": { "type": "string" },
        "createdAt": { "type": "string", "format": "date-time" },
        "updatedAt": { "type": "string", "format": "date-time" },
        "status": { "type": "string", "enum": ["ok", "manual_review"] }
      },
      "required": ["id", "year", "date", "description", "category", "societa", "createdBy", "createdAt", "updatedAt"]
    },
    "Deadline": {
      "title": "Deadline",
      "type": "object",
      "properties": {
        "id": { "type": "string" },
        "year": { "type": "number" },
        "dueDate": { "type": "string", "format": "date-time" },
        "description": { "type": "string" },
        "category": { "type": "string" },
        "expectedAmount": { "type": "number" },
        "paidAmount": { "type": "number" },
        "status": { "type": "string" },
        "societa": { "type": "string" }
      }
    },
    "EntityScore": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "EntityScore",
      "type": "object",
      "description": "Represents a reliability score for a client or supplier.",
      "properties": {
        "id": { "type": "string" },
        "societa": { "type": "string" },
        "userId": { "type": "string" },
        "entityName": { "type": "string" },
        "entityType": { "type": "string", "enum": ["client", "supplier"] },
        "reliabilityScore": { "type": "number" },
        "averagePaymentDelay": { "type": "number" },
        "totalTransactions": { "type": "number" },
        "onTimePercentage": { "type": "number" },
        "lastUpdated": { "type": "string", "format": "date-time" },
        "history": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "date": { "type": "string", "format": "date-time" },
              "score": { "type": "number" },
              "reason": { "type": "string" }
            }
          }
        }
      },
      "required": ["id", "societa", "userId", "entityName", "entityType", "reliabilityScore", "lastUpdated"]
    }
  },
  "firestore": {
    "structure": [
      {
        "path": "/movements/{movementId}",
        "definition": { "entityName": "Movement" }
      },
      {
        "path": "/deadlines/{deadlineId}",
        "definition": { "entityName": "Deadline" }
      },
      {
        "path": "/users/{userId}/entityScores/{scoreId}",
        "definition": { "entityName": "EntityScore" }
      }
    ]
  }
}